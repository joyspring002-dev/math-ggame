<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <title>체스 게임 (잡은 기물 표시)</title>
    <style>
        body {
            font-family: 'Segoe UI Emoji', 'Noto Color Emoji', 'Apple Color Emoji', sans-serif;
            background-color: #2c3e50;
            color: white;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            height: 100vh;
            margin: 0;
        }

        h1 { margin-bottom: 20px; text-shadow: 2px 2px 4px rgba(0,0,0,0.5); }

        /* 전체 게임 컨테이너 (보드 + 정보창) */
        .game-container {
            display: flex;
            gap: 40px; /* 보드와 정보창 사이 간격 */
            align-items: flex-start;
        }

        /* 체스판 스타일 */
        #board {
            display: grid;
            grid-template-columns: repeat(8, 70px);
            grid-template-rows: repeat(8, 70px);
            border: 15px solid #4e342e;
            border-radius: 5px;
            box-shadow: 0 10px 20px rgba(0,0,0,0.5);
            user-select: none;
        }

        .square {
            width: 70px;
            height: 70px;
            display: flex;
            justify-content: center;
            align-items: center;
            font-size: 50px; /* 기물 크기 키움 */
            cursor: pointer;
            position: relative;
        }

        .white-square { background-color: #f0d9b5; }
        .black-square { background-color: #b58863; }

        /* 기물 스타일 (가시성 확보) */
        .piece {
            cursor: pointer;
            z-index: 10;
        }
        /* 백색 기물: 하얀색에 검은 테두리 */
        .piece.white { 
            color: #fff; 
            text-shadow: 0 0 2px #000, 0 0 3px #000; 
        }
        /* 흑색 기물: 검은색 */
        .piece.black { 
            color: #000; 
        }

        .selected { background-color: #7b61ff !important; opacity: 0.8; }

        /* 오른쪽 정보창 스타일 */
        .info-panel {
            display: flex;
            flex-direction: column;
            gap: 20px;
            width: 250px;
            background-color: #34495e;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.3);
        }

        .turn-box {
            font-size: 1.2rem;
            font-weight: bold;
            text-align: center;
            padding: 10px;
            background-color: #2c3e50;
            border-radius: 5px;
            margin-bottom: 10px;
        }

        .captured-box {
            background-color: #ecf0f1;
            color: #333;
            padding: 10px;
            border-radius: 5px;
            min-height: 80px;
        }

        .captured-box h3 {
            margin: 0 0 10px 0;
            font-size: 0.9rem;
            color: #555;
            border-bottom: 1px solid #ccc;
            padding-bottom: 5px;
        }

        .captured-pieces {
            font-size: 25px; /* 잡은 기물 크기 */
            letter-spacing: 2px;
            word-wrap: break-word;
        }

    </style>
</head>
<body>

    <h1>♟️ 체스 게임 V2</h1>

    <div class="game-container">
        <!-- 왼쪽: 체스판 -->
        <div id="board"></div>

        <!-- 오른쪽: 정보창 -->
        <div class="info-panel">
            <div id="turn-indicator" class="turn-box">백(White) 차례</div>
            
            <!-- 백이 잡은 흑의 기물 -->
            <div class="captured-box">
                <h3>백이 잡은 기물 (Captured by White)</h3>
                <div id="captured-by-white" class="captured-pieces"></div>
            </div>

            <!-- 흑이 잡은 백의 기물 -->
            <div class="captured-box">
                <h3>흑이 잡은 기물 (Captured by Black)</h3>
                <div id="captured-by-black" class="captured-pieces"></div>
            </div>
            
            <div style="font-size: 0.8rem; color: #aaa; text-align: center; margin-top: 10px;">
                기물을 클릭하여 이동하세요.<br>(규칙 제한 없는 자유 모드)
            </div>
        </div>
    </div>

    <script>
        const boardElement = document.getElementById('board');
        const turnIndicator = document.getElementById('turn-indicator');
        const capturedByWhiteEl = document.getElementById('captured-by-white');
        const capturedByBlackEl = document.getElementById('captured-by-black');
        
        let selectedSquare = null;
        let isWhiteTurn = true;

        // 유니코드 기물 매핑
        const pieceIcons = {
            'r': '♜', 'n': '♞', 'b': '♝', 'q': '♛', 'k': '♚', 'p': '♟', // 흑
            'R': '♖', 'N': '♘', 'B': '♗', 'Q': '♕', 'K': '♔', 'P': '♙'  // 백
        };

        // 초기 보드 상태
        let boardState = [
            ['r', 'n', 'b', 'q', 'k', 'b', 'n', 'r'],
            ['p', 'p', 'p', 'p', 'p', 'p', 'p', 'p'],
            ['', '', '', '', '', '', '', ''],
            ['', '', '', '', '', '', '', ''],
            ['', '', '', '', '', '', '', ''],
            ['', '', '', '', '', '', '', ''],
            ['P', 'P', 'P', 'P', 'P', 'P', 'P', 'P'],
            ['R', 'N', 'B', 'Q', 'K', 'B', 'N', 'R']
        ];

        // 잡은 기물 저장소
        let capturedByWhite = []; // 백이 잡은 흑 기물들
        let capturedByBlack = []; // 흑이 잡은 백 기물들

        function createBoard() {
            boardElement.innerHTML = '';

            for (let row = 0; row < 8; row++) {
                for (let col = 0; col < 8; col++) {
                    const square = document.createElement('div');
                    const isWhiteSquare = (row + col) % 2 === 0;
                    
                    square.className = `square ${isWhiteSquare ? 'white-square' : 'black-square'}`;
                    square.dataset.row = row;
                    square.dataset.col = col;

                    const pieceCode = boardState[row][col];
                    if (pieceCode) {
                        const pieceSpan = document.createElement('span');
                        pieceSpan.textContent = pieceIcons[pieceCode];
                        pieceSpan.className = `piece ${pieceCode === pieceCode.toUpperCase() ? 'white' : 'black'}`;
                        square.appendChild(pieceSpan);
                    }

                    if (selectedSquare && selectedSquare.row === row && selectedSquare.col === col) {
                        square.classList.add('selected');
                    }

                    square.addEventListener('click', onSquareClick);
                    boardElement.appendChild(square);
                }
            }
            updateCapturedUI();
        }

        function updateCapturedUI() {
            // 백이 잡은 것 표시 (흑 기물 아이콘)
            capturedByWhiteEl.innerHTML = capturedByWhite.map(p => 
                `<span style="color:black;">${pieceIcons[p]}</span>`
            ).join(' ');

            // 흑이 잡은 것 표시 (백 기물 아이콘 - 잘 보이게 그림자 추가)
            capturedByBlackEl.innerHTML = capturedByBlack.map(p => 
                `<span style="color:white; text-shadow:0 0 2px black;">${pieceIcons[p]}</span>`
            ).join(' ');
        }

        function onSquareClick(e) {
            // 클릭한 요소가 square가 아니라 내부의 span(기물)일 경우 부모를 찾음
            let target = e.target;
            if (target.classList.contains('piece')) {
                target = target.parentElement;
            }

            const row = parseInt(target.dataset.row);
            const col = parseInt(target.dataset.col);
            const clickedPiece = boardState[row][col];

            // 1. 기물 선택
            if (!selectedSquare) {
                if (clickedPiece) {
                    const isPieceWhite = clickedPiece === clickedPiece.toUpperCase();
                    if ((isWhiteTurn && isPieceWhite) || (!isWhiteTurn && !isPieceWhite)) {
                        selectedSquare = { row, col };
                        createBoard(); // 선택 표시 갱신
                    }
                }
            } 
            // 2. 이동 (또는 공격)
            else {
                // 같은 곳 클릭 시 취소
                if (selectedSquare.row === row && selectedSquare.col === col) {
                    selectedSquare = null;
                    createBoard();
                    return;
                }

                // 이동하려는 곳에 있는 기물 확인 (잡기)
                const targetPiece = boardState[row][col];
                const movingPiece = boardState[selectedSquare.row][selectedSquare.col];

                // 아군 기물 위치로는 이동 불가
                if (targetPiece) {
                    const isTargetWhite = targetPiece === targetPiece.toUpperCase();
                    const isMovingWhite = movingPiece === movingPiece.toUpperCase();
                    if (isTargetWhite === isMovingWhite) {
                        // 아군 클릭 시 선택 변경
                        selectedSquare = { row, col };
                        createBoard();
                        return;
                    }
                }

                // 잡기 로직
                if (targetPiece) {
                    if (isWhiteTurn) {
                        capturedByWhite.push(targetPiece); // 백이 잡음
                    } else {
                        capturedByBlack.push(targetPiece); // 흑이 잡음
                    }
                }

                // 이동 처리
                boardState[selectedSquare.row][selectedSquare.col] = '';
                boardState[row][col] = movingPiece;

                // 턴 변경
                isWhiteTurn = !isWhiteTurn;
                turnIndicator.textContent = `${isWhiteTurn ? '백(White)' : '흑(Black)'} 차례`;
                
                selectedSquare = null;
                createBoard();
            }
        }

        createBoard();
    </script>
</body>
</html>