<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>í• ë¡œìœˆ êµ¬êµ¬ë‹¨</title>
    <style>
        body {
            margin: 0;
            padding: 0;
            background-color: #1a0500; /* ë°¤ìƒ‰ ë°°ê²½ */
            color: #FF7518; /* í˜¸ë°•ìƒ‰ */
            font-family: 'Courier New', Courier, monospace;
            overflow: hidden;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            height: 100vh;
        }

        #game-container {
            position: relative;
            width: 95%; 
            max-width: 800px;
            height: 70vh; 
            border: 3px solid #FF7518;
            background-color: #000000;
            box-shadow: 0 0 20px #FF7518;
            border-radius: 10px;
            /* ìº”ë²„ìŠ¤ ë°–ìœ¼ë¡œ ë‚˜ê°€ëŠ” ê¸€ì ìˆ¨ê¸°ê¸° */
            overflow: hidden; 
        }

        canvas {
            display: block;
            width: 100%;
            height: 100%;
        }

        #ui-layer {
            position: absolute;
            top: 15px;
            left: 15px;
            font-size: 1.2rem;
            font-weight: bold;
            color: #FF7518;
            pointer-events: none;
            text-shadow: 2px 2px #330000;
            z-index: 10;
        }

        #input-area {
            position: absolute;
            bottom: 15px;
            width: 100%;
            display: flex;
            justify-content: center;
            gap: 10px;
            z-index: 10;
        }

        #answer-input {
            font-size: 1.5rem;
            padding: 10px;
            width: 50%;
            text-align: center;
            background-color: #221100;
            color: #FF7518;
            border: 2px solid #FF7518;
            border-radius: 5px;
            outline: none;
            font-weight: bold;
        }

        #submit-btn {
            padding: 10px 20px;
            font-size: 1.2rem;
            background-color: #FF7518;
            color: #000;
            border: none;
            border-radius: 5px;
            font-weight: bold;
            cursor: pointer;
        }

        #game-over {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            text-align: center;
            display: none;
            background: rgba(20, 0, 0, 0.95);
            padding: 30px;
            border: 2px solid #FF7518;
            border-radius: 15px;
            width: 80%;
            z-index: 20;
        }
    </style>
</head>
<body>

    <div id="game-container">
        <canvas id="gameCanvas"></canvas>

        <div id="ui-layer">
            <span id="score-board">ğŸƒ ì ìˆ˜: 0</span> <br>
            <span id="life-board">ğŸ‘» ìƒëª…: 5</span>
        </div>

        <div id="game-over">
            <h1 style="color: #ff3333;">GAME OVER</h1>
            <p id="final-score" style="color: white; font-size: 1.5rem;">ìµœì¢… ì ìˆ˜: 0</p>
            <button onclick="startGame()" style="font-size: 1.2rem; padding: 10px 20px; background-color: #FF7518; border: none; cursor: pointer; border-radius: 5px;">ë‹¤ì‹œ ë„ì „!</button>
        </div>

        <div id="input-area">
            <input type="number" id="answer-input" placeholder="?" autocomplete="off">
            <button id="submit-btn">ê³µê²©</button>
        </div>
    </div>

    <script>
        const canvas = document.getElementById('gameCanvas');
        const ctx = canvas.getContext('2d');
        const inputField = document.getElementById('answer-input');
        const submitBtn = document.getElementById('submit-btn');
        const scoreBoard = document.getElementById('score-board');
        const lifeBoard = document.getElementById('life-board');
        const gameOverScreen = document.getElementById('game-over');
        const finalScoreText = document.getElementById('final-score');

        let score = 0;
        let lives = 5;
        let problems = [];
        let gameInterval;
        let spawnRate = 60; 
        let frameCount = 0;
        let isGameOver = false;

        // ìº”ë²„ìŠ¤ í¬ê¸° ë§ì¶”ê¸°
        function resizeCanvas() {
            const container = document.getElementById('game-container');
            canvas.width = container.clientWidth;
            canvas.height = container.clientHeight;
        }
        window.addEventListener('resize', resizeCanvas);

        function startGame() {
            resizeCanvas();
            score = 0;
            lives = 5;
            problems = [];
            isGameOver = false;
            frameCount = 0;
            spawnRate = 60; 
            
            scoreBoard.innerText = `ğŸƒ ì ìˆ˜: ${score}`;
            lifeBoard.innerText = `ğŸ‘» ìƒëª…: ${lives}`;
            gameOverScreen.style.display = 'none';
            inputField.value = '';
            inputField.focus();

            if (gameInterval) cancelAnimationFrame(gameInterval);
            gameLoop();
        }

        function gameLoop() {
            if (isGameOver) return;

            // í™”ë©´ ì§€ìš°ê¸°
            ctx.clearRect(0, 0, canvas.width, canvas.height);

            // ë¬¸ì œ ìƒì„± íƒ€ì´ë°
            frameCount++;
            if (frameCount % spawnRate === 0) {
                spawnProblem();
            }

            // ë¬¸ì œ ì´ë™ ë° ê·¸ë¦¬ê¸°
            for (let i = 0; i < problems.length; i++) {
                let p = problems[i];
                p.y += p.speed; 

                // í°íŠ¸ ì„¤ì •
                ctx.font = "bold 30px Courier New";
                
                // â˜… í•µì‹¬ ìˆ˜ì •: ê¸€ì ê¸°ì¤€ì„ ì„ ë§¨ ìœ„(top)ë¡œ ì„¤ì •í•´ì„œ ë°”ë¡œ ë³´ì´ê²Œ í•¨ â˜…
                ctx.textBaseline = 'top'; 
                
                // ìƒ‰ìƒ ë° ê·¸ë¦¼ì
                ctx.fillStyle = "#FF7518"; 
                ctx.shadowColor = "#550000";
                ctx.shadowBlur = 4;
                
                // ê¸€ì ê·¸ë¦¬ê¸°
                ctx.fillText(p.question, p.x, p.y);

                // ë°”ë‹¥ì— ë‹¿ì•˜ì„ ë•Œ
                if (p.y > canvas.height) {
                    lives--;
                    lifeBoard.innerText = `ğŸ‘» ìƒëª…: ${lives}`;
                    
                    // ë¹¨ê°„ìƒ‰ ë²ˆì©ì„ íš¨ê³¼
                    canvas.style.backgroundColor = '#330000';
                    setTimeout(() => canvas.style.backgroundColor = '#000000', 100);

                    problems.splice(i, 1);
                    i--; // ì¸ë±ìŠ¤ ì¡°ì •
                    if (lives <= 0) endGame();
                }
            }
            // ê·¸ë¦¼ì íš¨ê³¼ ì´ˆê¸°í™”
            ctx.shadowBlur = 0;
            
            gameInterval = requestAnimationFrame(gameLoop);
        }

        function spawnProblem() {
            const num1 = Math.floor(Math.random() * 8) + 2;
            const num2 = Math.floor(Math.random() * 9) + 1;
            
            // X ì¢Œí‘œ: í™”ë©´ ë°–ìœ¼ë¡œ ë‚˜ê°€ì§€ ì•Šê²Œ ì—¬ìœ ë¥¼ ë‘  (ê¸€ì í¬ê¸° ê³ ë ¤)
            const x = Math.random() * (canvas.width - 150) + 20; 
            
            // â˜… í•µì‹¬ ìˆ˜ì •: ì†ë„ë¥¼ ë„ˆë¬´ ëŠë¦¬ì§€ ì•Šê²Œ í˜„ì‹¤ì ìœ¼ë¡œ ì¡°ì • (1.0 ~ 2.0) â˜…
            // ì²œì²œíˆ ë‚´ë ¤ì˜¤ì§€ë§Œ ë‹µë‹µí•˜ì§€ ì•Šì€ ì†ë„ì…ë‹ˆë‹¤.
            const speed = Math.random() * 1.0 + 1.0 + (score / 300); 

            problems.push({ 
                x: x, 
                // Y ì¢Œí‘œ: í™”ë©´ ë§¨ ìœ„(0)ì—ì„œ ì‹œì‘
                y: 0, 
                question: `${num1} x ${num2}`, 
                answer: (num1 * num2).toString(), 
                speed: speed 
            });
        }

        function endGame() {
            isGameOver = true;
            gameOverScreen.style.display = 'block';
            finalScoreText.innerText = `ìµœì¢… ì ìˆ˜: ${score}`;
            cancelAnimationFrame(gameInterval);
        }

        function checkAnswer() {
            const value = inputField.value.trim();
            for (let i = 0; i < problems.length; i++) {
                if (problems[i].answer === value) {
                    score += 10;
                    scoreBoard.innerText = `ğŸƒ ì ìˆ˜: ${score}`;
                    
                    // ë§ì¶”ë©´ í•˜ì–€ìƒ‰ìœ¼ë¡œ ì ê¹ í‘œì‹œ í›„ ì‚­ì œ
                    ctx.fillStyle = "white";
                    ctx.textBaseline = 'top';
                    ctx.fillText(problems[i].question, problems[i].x, problems[i].y);
                    
                    problems.splice(i, 1);
                    break;
                }
            }
            inputField.value = '';
            inputField.focus();
        }

        inputField.addEventListener('keydown', function(event) {
            if (event.key === 'Enter') checkAnswer();
        });

        submitBtn.addEventListener('click', checkAnswer);

        // í˜ì´ì§€ ë¡œë“œ ì‹œ ë°”ë¡œ ì‹œì‘
        startGame();
    </script>
</body>
</html>